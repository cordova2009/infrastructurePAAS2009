##查询会员信息接口

前端页面通过该接口查询会员接口

http请求方式: post


    http://ip:port/if/member/queryMemberInfo


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },        
        "body":
        {
	    "token":"6789"
	 }
    }

参数|是否必须|说明
----|----|-----
token|否|用户令牌


2）返回说明

正常时的返回JSON数据包示例：
 
    {"errcode":0,"errmsg":"查询会员信息成功",
    "info":[{
        "isMember":"OK#",
        "memberStartTime":"",
        "memberEndTime":"",
        "memberType":"",
        "memberContent":""
	}]
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询会员信息失败"}

参数|是否必须|说明
----|----|-----
isMember|是|会员身份属性,NCP 未资质认证,NON 非会员,OK# 会员,EPE 会员过期
memberStartTime|否|会员开始时间
memberEndTime|否|会员结束时间
memberType|否|会员类型
memberContent|否|会员特权

注: 未资质认证,非会员 时没有"会员开始时间","会员结束时间","会员类型","会员特权"

##查询可购买会员列表接口

前端页面通过该接口查询可购买的会员产品

http请求方式: post


    http://ip:port/if/member/queryMemberProduct


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },        
        "body":
        {
	    "token":"12345"
	   }
    }

2）返回说明

正常时的返回JSON数据包示例：
 
    {"errcode":0,"errmsg":"查询可购买会员列表成功",
    	results:[{
    	   "productName":"标准会员",
    	   "memberType":"TER",
    	   "productPrice":"30000",
    	   "productDesc":"招标方会员，购买后你将拥有xxx",
    	   "productId":"teeL1"
    	 }],
    	"terMember":"OK#",
    	"terMemberExpireTime":"2016-03-09",
    	"birMember":"NON",
    	"birMemberExpireTime":""

    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询会员信息失败"}

参数|是否必须|说明
----|----|-----
productName|是|产品名称
memberType|否|会员类型，TER招标人会员，BIR投标人会员
productPrice|是|产品单价，单位为分
productDesc|是|产品描述
productId|是|产品id
terMember|是|是否招标方会员,NCP 未资质认证,NON 非会员,OK# 会员,EPE 会员过期
terMemberExpireTime|是|招标方会员到期时间
birMember|是|是否投标方会员,NCP 未资质认证,NON 非会员,OK# 会员,EPE 会员过期
birMemberExpireTime|是|投标方会员到期时间

注: 当terMember和birMember是NCP 未资质认证,不能购买会员,OK# 也不能购买会员


##购买招标方会员接口

前端页面通过该接口成为招标方会员接口


http请求方式: post

前置条件：用户必须先登录,


    http://ip:port/if/member/BiddeeMember


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },        
        "body":
        {
	       "token":"12345",
           "productId":"BIDDEE_MEMBER_STD"

	     }
    }

参数|是否必须|说明
----|----|-----
token|是|用户令牌
productId|是|产品ID


2）返回说明

正常时的返回JSON数据包示例：
 
    {"errcode":0,"errmsg":"购买会员成功","orderId":"ZH00201501010000003243274"}

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"购买会员失败"}

    {"errcode":210106,"errmsg":"您已是会员"}


处理流程:

    1. 查询用户的身份,如果用户不是通过招标人资质,不能购买.如果用户已有招标人会员(在有效期内),则也不能购买

    2. 检查用户的订单表有没有购买招标人会员的订单,订单状态为CRT(待支付),调用支付宝网关,查询订单状态

    	如果有记录,记录状态可为 OK#已支付,FLS支付失败,NON没有处理,OTH其它状态(如订单取消)

    	2.1 如果为已支付,则把订单状态改为已支付,且为用户添加会员身份(如果原来没有会员,则添加会员,如果原来有会员,则调整会员的开始时间和结束时间),在会员升级表添加一条历史记录,并且返回{"errcode":210106,"errmsg":"您已是会员"},其中errcode中的 21010 要根据功能编号来改.

    	2.2 如果为支付失败,则把订单状态改为支付失败,且生成一条新的订单,返回订单号.

    	2.3 如果支付状态为没有处理,则直接返回这个订单号.

    	2.4 如果状态是其它,则把订单状态改为支付失败,且生成一条新的订单,返回订单号.

    3. 如果第2步查询订单时,查询不到订单,则新建一条订单,返回订单号



##购买投标方会员接口

前端页面通过该接口成为投标方会员接口


http请求方式: post

前置条件：用户必须先登录,


    http://ip:port/if/member/buyTenderMember


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },        
        "body":
        {
	       "token":"12345",
	       "productId":"BIDDER_MEMBER_STD"

	    }
    }

参数|是否必须|说明
----|----|-----
token|是|用户令牌
productId|是|产品ID



2）返回说明

正常时的返回JSON数据包示例：
 
    {"errcode":0,"errmsg":"购买会员成功","orderId":"TH00201501010000003243274"}

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"购买会员失败"}

    {"errcode":210206,"errmsg":"您已是会员"}

处理流程:

    1. 查询用户的身份,如果用户不是通过招标人资质,不能购买.如果用户已有招标人会员(在有效期内),则也不能购买

    2. 检查用户的订单表有没有购买投标人会员的订单,订单状态为CRT(待支付),调用支付宝网关,查询订单状态

    	如果有记录,记录状态可为 OK#已支付,FLS支付失败,NON没有处理,OTH其它状态(如订单取消)

    	2.1 如果为已支付,则把订单状态改为已支付,且为用户添加会员身份(如果原来没有会员,则添加会员,如果原来有会员,则调整会员的开始时间和结束时间),在会员升级表添加一条历史记录,并且返回{"errcode":210106,"errmsg":"您已是会员"},其中errcode中的 21010 要根据功能编号来改.

    	2.2 如果为支付失败,则把订单状态改为支付失败,且生成一条新的订单,返回订单号.

    	2.3 如果支付状态为没有处理,则直接返回这个订单号.

    	2.4 如果状态是其它,则把订单状态改为支付失败,且生成一条新的订单,返回订单号.

    3. 如果第2步查询订单时,查询不到订单,则新建一条订单,返回订单号