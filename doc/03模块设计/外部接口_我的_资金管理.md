#目的

本文档设计我的资金管理（capitalManage）接口，用于指导开发。

#接口

##获取平台方银行账户接口

用户在线下通过银行向平台运营公司转账后，向平台方提交充值凭证，平台方审核通过后，向用户的资金账户充值。

1）请求说明

http请求方式: post


    http://IP:PORT/if/capitalManage/getPlatformBankcard


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN"
        }
    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"获取平台方银行账户成功"
        "bankInfo":{
            "accountId":"ACCOUNTID",
			"accountName":"账户名称",
			"bankName":"银行名称"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"获取平台方银行账户失败"}
    
参数|是否必须|说明
----|----|-----
accountId|是|账户Id
accountName|是|账户名称
bankName|是|银行名称
    


##充值申请接口

用户在线下通过银行向平台运营公司转账后，向平台方提交充值凭证，平台方审核通过后，向用户的资金账户充值。

1）请求说明

http请求方式: post


    http://IP:PORT/if/capitalManage/rechargeApply


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN",
            "transferTime":"2015-10-12",
            "bankName":"中国银行",
            "voucherNo":"20150101215522",
            "amount":100000,
            "voucherFileUrl":"VOCHER_FILE_URL"
        }
    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌
transferTime|是|转账时间,单位天
bankName|是|银行名称
voucherNo|是|转账凭证号
amount|是|充值金额,单位分
voucherFileUrl|是|凭证上传地址

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"提交充值申请成功"
        "order":{
            "orderId":"ORDERID"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"提交充值申请失败"}
    

    
##提现申请接口

用户向平台方申请提现，平台方审核通过后，向用户的开户行转账，转账成功后，并登记转账凭证给用户查阅。

1）请求说明

http请求方式: post


    http://IP:PORT/if/capitalManage/withdrawalsApply


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN",
            "amount":100000,
            "bankId":"BANK_ID",
            "tradePassword":"TRADE_PASSWORD"
        }
    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌
amount|是|提现金额,单位分
bankId|是|银行账号编号
tradePassword|是|交易密码

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"提现申请成功",
        "order":{
           "orderId":"ORDERID"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"提现申请失败"}


##查询我的银行账号信息接口

用户在线下通过银行向平台运营公司转账后，向平台方提交充值凭证，平台方审核通过后，向用户的资金账户充值。

1）请求说明

http请求方式: post


    http://IP:PORT/if/capitalManage/getMyBankInfo


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN"
        }
    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"查询我的银行账户信息成功"
        "bankInfo":[{
            "bankId":"BANK_ID", 
            "bank":"招商银行深圳支行",
            "accountId":"1234567812345678",
            "accountName":"深圳麦圈互动技术有限公司"
        },
        {
            "bankId":"BANK_ID", 
            "bank":"招商银行深圳支行",
            "accountId":"1234567812345678",
            "accountName":"深圳麦圈互动技术有限公司"
        }]
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询我的银行账户信息失败失败"}  



##查询申请提现记录接口

用户可以通过查询申请提现记录，了解提现申请进展。

1）请求说明

http请求方式: post


    http://IP:PORT/if/capitalManage/queryWithdrawalsApplyList


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN"
        }
    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"查询申请提现记录成功",
        "list":{
            "createTime":"2015-10-10 10:00:00",
            "amount":"2000.00",
            "handingCharge":"20.00",
            "status":"DON",
            "remark":"已经银行转账，预计10月12日到账",
            "withdrawalsDate":"2015-10-12",
            "withdrawalsNo":"WITHDRAWAL_NO"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询信息失败，其它错误"}

参数|是否必须|说明
----|----|-----
createTime|是|提现申请日期
amount|是|申请提现金额
handlingCharge|是|提现手续费
status|是|状态，CRT-申请中待审核，OK#-提现成功，FLS-提现失败
remark|是|备注
withdrawalsDate|是|转账日期
withdrawalsNo|是|转账凭证号

##查询充值申请记录接口

用户可以通过查询充值申请记录，了解充值进展。

1）请求说明

http请求方式: post


    http://IP:PORT/if/capitalManage/queryRechargeApplyList


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN"
        }
    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"查询申请提现记录成功",
        "list":{
            "createTime":"2015-10-10 10:00:00",
            "amount":"2000.00",
            "status":"DON",
            "remark":"已经收到款项，谢谢",
            "rechargeTime":"2015-10-12 10:00:00",
            "voucherNo":"VOUCHER_NO"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询信息失败，其它错误"}

参数|是否必须|说明
----|----|-----
createTime|是|充值申请日期
amount|是|充值金额
status|是|状态，CRT-申请中待确认，OK#-充值成功，FLS-充值失败
remark|是|备注
rechargeTime|是|转账日期
voucherNo|是|转账凭证号


##查询我的资金账户流水接口

查询用的资金账户流水。

1）请求说明

http请求方式: post


    http://IP:PORT/if/capitalManage/queryTransactionRecords


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN",
            "pageIndex":0,
	        "pageSize":10
        }

    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌


2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"查询资金交易记录成功","pageSize":10,"pageIndex":0,"total":100,
        "list":[{
            "time":"2015-09-19 08:21:12",
            "type":"TEE",
            "income":"10000.00",
            "outlay":"0.00",
            "balance":"2000.00",
            "remark":"xxxx"
        }]
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询资金账户交易记录失败"}

参数|是否必须|说明
----|----|-----
add_time|是|交易时间
type|是|交易类型,TEE,招标方，TER,投标方
income|是|收入，单位元
outlay|是|支出，单位元
balance|是|结余，单位元
remark|是|备注


##查询我的资金账户概况接口

查询我的资金账户概况。

1）请求说明

http请求方式: post

    http://IP:PORT/if/capitalManage/queryMyCapital


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN"
        }
    } 


参数|是否必须|说明
----|----|-----
appId|是|应用ID
timestamp|是|时间戳
nonce|是|随机数
signature|是|签名值,MD5(按值的字典顺序排列组合成字符串(appId,appKey,app.nonce,app.timeStamp))
token|是|用户令牌



2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"查询我的资金账户信息成功",
        "myCapitalInfo":{
        "balance":"100000.00",
        "freezeAmount":"90000.00",
        "imcome":"50000.00",
        "outlay":"60000.00"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询我的资金账户信息失败，其它错误"}

参数|是否必须|说明
----|----|-----
balance|是|结余
freezeAmount|是|冻结金额
income|是|收入
outlay|是|支出


##冻结撮合担保金接口

用户作为投标人进行投标时，需要冻结撮合担保金。如果中标了，该担保金将转化为撮合手续费，如果有多余，则退还到资金账户中。如果流标，将立即解冻返回到资金账户。

1）请求说明

http请求方式: post

    http://IP:PORT/if/capitalManage/freezeBond


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN",
            "amount":5000000,
            "originalOrderId":"BZ00201524562456u7",
            "originalTable":"t_ztgl_object_makematch_bond_record",
            "objectId":"BH0020150986432";
            "remark":"冻结50000元施工保证金",
            "tradePassword":"TRADE_PASSWORD"
        }
    } 


参数|是否必须|说明
----|----|-----
appId|是|应用ID
timestamp|是|时间戳
nonce|是|随机数
signature|是|签名值,MD5(按值的字典顺序排列组合成字符串(appId,appKey,app.nonce,app.timeStamp))
token|是|用户令牌
amount|是|冻结撮合担保金金额,单位为分
originalOrderId|否|关联订单号
originalTable|否|关联表名
objectId|否|项目内部编号
remark|是|备注
tradePassword|是|交易密码，需要MD5

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"冻结撮合担保金成功",
        "order":{
            "orderId":"ORDER_ID"
            "accountId":"1234123412341234",
            "type":"见数据库定义",
            "flowDirection":"OUT",
            "balance":"30000.00",
            "amount":"20000.00",
            "remark":"冻结30000元撮合担保金"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"冻结撮合担保金失败"}

参数|是否必须|说明
----|----|-----
orderId|是|账户流水订单编号
accountId|是|账号
type|是|交易类型
flowDirection|是|流向
balance|是|结余
amount|是|冻结金额
remark|是|备注

##解冻撮合保证金接口

用户作为投标人进行投标时，需要冻结施工保证金。如果中标了，直到工程施工结束，该保证金才能解冻。如果流标，将立即解冻返回到资金账户。

1）请求说明

http请求方式: post

    http://IP:PORT/if/capitalManage/unfreezeBond


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN",
            "orderId":"ORDER_ID",
            "objectId":"BZ20148978654",
            "remark":"解冻撮合担保金成功"
        }
    } 


参数|是否必须|说明
----|----|-----
appId|是|应用ID
timestamp|是|时间戳
nonce|是|随机数
signature|是|签名值,MD5(按值的字典顺序排列组合成字符串(appId,appKey,app.nonce,app.timeStamp))
token|是|用户令牌
orderId|是|账户冻结流水订单编号
objectId|是|关联项目内部编号
remark|是|备注

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"解冻撮合担保金成功",
        "order":{
            "orderId":"ORDER_ID"
            "accountId":"1234123412341234",
            "type":"见数据库定义",
            "flowDirection":"OUT",
            "amount":"30000.00",
            "balance":"30000.00",
            "remark":"解冻30000元撮合担保金"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"解冻撮合担保金失败"}

参数|是否必须|说明
----|----|-----
orderId|是|冻结撮合担保金订单
accountId|是|账号
type|是|交易类型
flowDirection|是|流向
amount|是|解冻金额
balance|是|结余
remark|是|备注


##支付撮合手续费接口

在招标人定标时执行此接口,用于把中标的投标人的资金转移到平台帐户,并把不中标的投标人的资金解冻 

1）请求说明

http请求方式: post

    http://IP:PORT/if/capitalManage/payMatchHandingCharge


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN",
            "orderId":"ORDER_ID",
            "appOrderId":"APP_ORDER_ID",
            "lose":[{"orderId":"ORDER_ID","appOrderId":"APP_ORDER_ID"}]
        }
    } 


参数|是否必须|说明
----|----|-----
appId|是|应用ID
timestamp|是|时间戳
nonce|是|随机数
signature|是|签名值,MD5(按值的字典顺序排列组合成字符串(appId,appKey,app.nonce,app.timeStamp))
token|是|用户令牌
orderId|是|需要解冻的订单号
payAmount|是|需要支付的撮合手续费
lose|是|没中标的订单号

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"解冻施工保证金成功",
        "result":{
            "orderId":"ORDER_ID",
            "appOrderId":"APP_ORDER_ID",
            "lose":[{"orderId":"ORDER_ID","appOrderId":"APP_ORDER_ID"}]
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"解冻施工保证金失败"}

参数|是否必须|说明
----|----|-----
unfreezOrders|是|解冻的订单
matchOrder|是|把撮合保证金转移到平台后的订单
orderId|是|冻结撮合担保金订单
accountId|是|账号
type|是|交易类型
flowDirection|是|流向
amount|是|解冻金额或手续费金额
balance|是|结余
remark|是|备注


##（从资金账户）支付接口

用于购买会员服务时，使用资金账户支付。

1）请求说明

http请求方式: post

    http://IP:PORT/if/capitalManage/pay


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"32456768",
    	    "amount":100000,
    	    "tradePassword":"TRADE_PASSWORD",
    	    "remark":"购买1000元会员服务"
        },
    } 


参数|是否必须|说明
----|----|-----
appId|是|应用ID
timestamp|是|时间戳
nonce|是|随机数
signature|是|签名值,MD5(按值的字典顺序排列组合成字符串(appId,appKey,app.nonce,app.timeStamp))
token|是|用户令牌
tradePassword|是|交易密码
amount|是|支付金额
remark|是|备注



2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"从资金账户支付成功",
        "order":{
            "orderId":"ORDER_ID"
            "accountId":"1234123412341234",
            "type":"见数据库定义",
            "flowDirection":"OUT",
            "amount":"1000.00",
            "balance":"30000.00",
            "remark":"购买1000元会员服务"
        }
     }}

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"从资金账户支付失败，其它错误"}

参数|是否必须|说明
----|----|-----
orderId|是|冻结撮合担保金订单
accountId|是|账号
type|是|交易类型，见数据库定义
flowDirection|是|流向
amount|是|支付金额
balance|是|结余
remark|是|备注


##查询用户帐户详情接口

通过接口查询用户帐户详情.

1）请求说明

http请求方式: post


    http://IP:PORT/if/capitalManage/queryProjectAccount


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"12345"
        }
    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"查询用户帐户详情成功",
        "account":{
            "accountId":"210029328478272",
            "remainingSum":2000,
            "frozenSum":2000,
            "status":"OK#"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询用户帐户详情，其它错误"}

参数|是否必须|说明
----|----|-----
accountId|是|帐号
remainingSum|是|可用金额
status|是|状态，OK#正常,END 结束,FLS 异常
frozenSum|是|冻结金额


##平台方收入接口

此接口用于平台方资金帐户收入资金

1）请求说明

http请求方式: post

    http://IP:PORT/if/capitalManage/platformIncome


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "amount":5000000,
            "appOrderId":"fdsfdsfds"
        }
    } 


参数|是否必须|说明
----|----|-----
appId|是|应用ID
timestamp|是|时间戳
nonce|是|随机数
signature|是|签名值,MD5(按值的字典顺序排列组合成字符串(appId,appKey,app.nonce,app.timeStamp))
amount|是|收入资金
appOrderId|是|第三方应用id


2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"平台方收入成功",
        "order":{
            "orderId":"ORDER_ID"
            "accountId":"1234123412341234",
            "type":"见数据库定义",
            "flowDirection":"OUT",
            "balance":"30000.00",
            "amount":"20000.00",
            "remark":"冻结30000元撮合担保金"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"平台方收入失败"}

参数|是否必须|说明
----|----|-----
orderId|是|账户流水订单编号
accountId|是|账号
type|是|交易类型
flowDirection|是|流向
balance|是|结余
amount|是|冻结金额
remark|是|备注


##平台方支出接口

此接口用于平台方资金帐户支出资金

1）请求说明

http请求方式: post

    http://IP:PORT/if/capitalManage/platformPay


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "amount":5000000,
            "appOrderId":"fdsfdsfds"
        }
    } 


参数|是否必须|说明
----|----|-----
appId|是|应用ID
timestamp|是|时间戳
nonce|是|随机数
signature|是|签名值,MD5(按值的字典顺序排列组合成字符串(appId,appKey,app.nonce,app.timeStamp))
amount|是|支出资金
appOrderId|是|第三方应用id


2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"平台方支出成功",
        "order":{
            "orderId":"ORDER_ID"
            "accountId":"1234123412341234",
            "type":"见数据库定义",
            "flowDirection":"OUT",
            "balance":"30000.00",
            "amount":"20000.00",
            "remark":"冻结30000元撮合担保金"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"平台方支出失败"}

参数|是否必须|说明
----|----|-----
orderId|是|账户流水订单编号
accountId|是|账号
type|是|交易类型
flowDirection|是|流向
balance|是|结余
amount|是|冻结金额
remark|是|备注



