
#目的

本文档用于指导用户中心（UserCenter）编码实现。
UserCenter负责非安全部分的用户管理功能。
UserSecurity负责安全部分的用户管理功能。

#接口

##查询用户状态接口

根据手机号码查询用户状态，用于注册、忘记密码等功能时，判断用户号码是否存在，是否可用等。

1）请求说明

http请求方式: post

    http://IP:PORT/if/userCenter/getUserStatus


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	    "body":{
	       "mobileNum":"13655641234"
	    }
    }


参数|必须|说明
------|------|-------
mobileNum|是|手机号码

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"查询用户状态成功",
        "status":"OK#"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"查询用户状态失败，其它错误"
    }


参数|必须|说明
----|----|----
status|是|用户存状态，OK#：用户存在且正常。DIS：用户存在但禁用。BLI：黑名单用户。NEX：不存在的用户。


##实名校验接口

校验身份证的证件号和姓名是否一致，是否真实。

由于当前未连接公安部的身份证系统，当前只校验身份证号是否正确。

1）请求说明

http请求方式: post

    http://IP:PORT/if/userCenter/isRealName


POST数据格式：JSON

     {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "realName":"王亚锋",
            "cardID":"610522222222222838"
        }
    }


参数|必须|说明
------|------|-------
realName|是|姓名
cardID|是|身份证号

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"实名校验成功",
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"实名校验失败，其它错误"
    }



###查看帐户基础信息接口

本接口用来获取已经登录的用户基本信息，身份证号和手机号码需要加*显示。

1）请求说明


http请求方式: post

    http://IP:PORT/if/userInfo/getUserBaseInfo




POST数据格式：JSON

     {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	{
            "token":"12345678900987654321"
	}
    }


参数|必须|说明
------|------|-------
token|是|用户令牌


2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"查看帐户基础信息成功", 
        "user":{
            "nikeName":"SH12345",
            "realName":"ST12345",
            "cardID":"ZJ000001",
            "mobileNum":"13657256768",
            "email":"123123123122132",
            "address":"1234567890123456789",
            "headImageUrl":"http://xxxx.xxx/head.jpg"
        }
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"用户不存在",
    }

参数|必须|说明
----|----|----
nikeName|是|用户昵称
address|是|联系地址
realName|是|真实姓名
cardID|是|身份证号
mobileNum|是|手机号码
email|是|邮箱
headImageUrl|是|头像



###查询安全信息接口

本接口用来获取已经登录的用户安全信息，身份证号和手机号码需要加*显示。

1）请求说明


http请求方式: post

    http://IP:PORT/if/userInfo/getUserSafetyInfo




POST数据格式：JSON

     {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	{
            "token":"12345678900987654321"
	}
    }


参数|必须|说明
------|------|-------
token|是|用户令牌


2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"查看帐户基础信息成功", 
        "user":{
            "nikeName":"SH12345",
            "mobileNum":"13657256768",
            "email":"123123123122132",
	    "realName":{
		"cardName":"ST12345",
		"cardID":"ZJ000001",
		"isRealName":"TRU"
	    }
        }
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"用户不存在"
    }

参数|必须|说明
----|----|----
nikeName|是|用户昵称
address|是|联系地址
realName|是|实名认证信息
realName.isRealName|是|是否实名认证 TRU，认证通过，FLS，认证失败，CRT，未认证
realName.cardID|是|身份证号
realName.cardName|是|身份证姓名
mobileNum|是|手机号码
email|是|邮箱
headImageUrl|是|头像


##用户注册接口

游客注册成为普通用户的接口。【需要完善】

1）请求说明

http请求方式: post

    http://IP:PORT/if/userInfo/register


POST数据格式：JSON

     {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
	        "smsCode":"564"
            "nikeName":"nikename", 
            "mobileNum":"13912345678",
            "realName":"王亚锋",
            "cardID":"610522222222222838",
            "loginPassword":"123123123",
            "tradePassword":"ssssssss"
    }
    }


参数|必须|说明
------|------|-------
smsCode|是|短信验证码，要求6个数字
nikeName|是|昵称
mobileNum|是|注册人手机号码
realName|是|注册人姓名(用DES加密，不允许明文传输)
cardID|是|注册人身份证号（用DES加密，不允许明文传输）
loginPassword|是|登录密码（需要MD5，不允许保存密码）
tradePassword|是|交易密码（需要MD5，不允许保存密码）



2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"用户注册成功",
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"用户注册失败，其它错误"
    }



###用户登录接口

游客可通过页面进行登录，以注册用户身份查询系统信息。

当用户连续3次登录失败，需要前端增加图形验证码校验。

1）请求说明

http请求方式: post

    http://IP:PORT/if/userInfo/login


POST数据格式：JSON

 {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        }
        ,
        "body"{
            "mobileNum":"13692228034",
            "loginPassword":"XXXXXXXX"
        }
}


参数|必须|说明
------|------|-------
mobileNum|是|用户手机号码
loginPassword|是|登录密码（md5）

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"登录成功",
        "user":{
            "token":"12345678901234567890",
            "mobileNum":"13912345678", 
            "nikeName":"SH01",
	        "headImageUrl":"URL"
        }
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"用户不存在或密码错误"
    }
【错误码要修改】


参数|必须|说明
----|----|----
token|是|用户令牌
mobileNum|是|用户手机号码
nikeName|是|用户昵称
headImageUrl|是|用户头像地址



##重置登录密码接口

用户在忘记密码的时候可以通过重置登录密码。该接口仅限于前端使用。

1）请求说明


http请求方式: post

    http://IP:PORT/if/userInfo/forgetPassword


POST数据格式：JSON
 {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "smsCode":"324545",
            "mobileNum":"13912345678",
            "loginPassword":"786456"
        }
    }


参数|必须|说明
----|----|----
smsCode|是|短信验证码
loginPassword|是|新登录密码（需要MD5，不允许存储密码）
mobileNum|是|重置密码的手机号

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"重置密码成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"用户不存在"
    }
    【完善错误码】



###修改帐户基础信息接口

本接口用来修改已经登录的用户基本信息。

1）请求说明


http请求方式: post

    http://IP:PORT/if/userInfo/updateUserInfo




POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	"body":{
	    "token":"54365769",
            "nikename":"XXX",
	    "address":"",
	    "headImageUrl":"http://www.baidu.com/xxxfile/qqqwcuhb/",
	    "email":""

	}
    }


参数|必须|说明
----|----|----
token|是|用户令牌
nikeName|是|用户昵称
address|是|地址
headImageUrl|是|头像
email|是|邮箱

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"修改帐户基础信息成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"修改帐户基础信息失败"
    }



###修改登录密码接口

用户自行修改登录密码接口，前提为，用户需记得当前密码。
前置条件：登录

1）请求说明


http请求方式: post

    http://IP:PORT/if/userSecurity/updateLoginPassword


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	"body":{   
            "token":"54365769",
	    "smsCode":"324545",
            "oldPassword":"231EEREWQR",
	    "newPassword":"3425"
	}
    }


参数|必须|说明
------|------|-------
token|是|用户令牌
smsCode|是|短信验证码
oldPassword|是|旧登录密码
newPassword|是|新登录密码

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"修改登录密码成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"旧密码错误"
    }


###修改交易密码接口

用户修改自己的交易密码

1）请求说明

http请求方式: post

    http://IP:PORT/if/userInfo/changeTradePassword


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	"body":{
            "token":"54365769",
	    "smsCode":"324545",
	    "loginPassword":"456787"
            "oldPassword":"231EEREWQR",
	    "newPassword":"3425"
	}
    }

参数|必须|说明
------|------|-------
token|是|用户令牌
smsCode|是|短信验证码
loginPassword|是|登录密码md5
oldPassword|是|旧登录密码md5
newPassword|是|新登录密码md5


2）返回说明

正常时的返回JSON数据包示例：

   正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"交易密码修改成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"交易密码修改失败"
    }


###修改绑定手机接口

用户修改绑定的手机号码

1）请求说明

http请求方式: post

    http://IP:PORT/if/userInfo/changeMobile


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	"body":{
            "token":"54365769",
	    "firSmsCode":"324545",
	    "senSmsCode":"435674",
	    "loginPassword":"234356475",
            "oldMobile":"13657253221",
	    "newMobile":"13657265432"
	}
    }

参数|必须|说明
------|------|-------
token|是|用户令牌
firSmsCode|是|第一步短信验证码
senSmsCode|是|第二步短信验证码
loginPassword|是|登录密码
token|是|用户令牌
oldmobilenum|是|旧手机号
newmobilenum|是|新手机号


2）返回说明

正常时的返回JSON数据包示例：

   正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"手机号码修改成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"旧手机号码不存在"
    }


###查询银行卡列表接口

该接口用来查看用户当前账号下关联的银行卡信息，银行卡号加密，开户名加密

1）请求说明


http请求方式: post

    http://IP:PORT/if/userInfo/queryBankInfoList


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	"body":{
            "token":"1231235467"
	}
    }


参数|必须|说明
------|------|-------
token|是|用户令牌


2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"查询成功", 
        "contract":[{
            "cardNum":"123123123",
            "account":"深圳麦圈",
            "bank":"招商银行",
	    "subBranch":"支行",
        }],
        "outsource":[{
            "cardNum":"1231233123",
            "account":"深圳麦圈",
            "bank":"招商银行",
	    "subBranch":"支行",
        }]
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"查询失败"
    }

参数|必须|说明
----|----|----
contract|是|承包方卡号列表
outsource|是|发包方卡号列表
cardNum|是|账户
account|是|账户名
bank|是|开户行
subBranch|是|开户支行








