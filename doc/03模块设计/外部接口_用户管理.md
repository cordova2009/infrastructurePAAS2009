
#目的

本文档用于指导用户中心（UserCenter）编码实现。
UserCenter负责非安全部分的用户管理功能。
UserSecurity负责安全部分的用户管理功能。

#接口

##注册和登录

###用户注册接口

游客注册成为普通用户的接口。

1）请求说明

http请求方式: post

    http://IP:PORT/if/userCenter/register


POST数据格式：JSON

     {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "smsCode":"123456"
            "nickname":"dudu", 
            "mobileNum":"13912345678",
            "realName":"王亚锋",
            "cardID":"610522222222222838",
            "loginPassword":"LOGIN_PASSWORD",
            "tradePassword":"TRADE_PASSWORD"
        }
    }


参数|必须|说明
------|------|-------
smsCode|是|短信验证码，要求6个数字
nickname|是|昵称
mobileNum|是|注册人手机号码
realName|是|注册人姓名(用DES加密，不允许明文传输)
cardID|是|注册人身份证号（用DES加密，不允许明文传输）
loginPassword|是|登录密码（需要MD5，不允许保存密码）
tradePassword|是|交易密码（需要MD5，不允许保存密码）



2）返回说明

正常时的返回JSON数据包示例：

    {"errcode":0,"errmsg":"用户注册成功"}

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"用户注册失败"
    }

需要处理的错误码：

    {
        "errcode":??????,"errmsg":"用户注册失败：短信验证码不正确"
    }

    {
        "errcode":??????,"errmsg":"用户注册失败：用户已经存在，不可以重复注册"
    }


###用户登录接口

游客可以通过用户登录接口登录系统。

当用户连续3次登录失败，需要前端增加图形验证码校验。

1）请求说明

http请求方式: post

    http://IP:PORT/if/userCenter/login


POST数据格式：JSON

 {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        }
        ,
        "body"{
            "mobileNum":"13692228034",
            "loginPassword":"LOGIN_PASSWORD"
        }
}


参数|必须|说明
------|------|-------
mobileNum|是|用户手机号码
loginPassword|是|登录密码（md5）

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"登录成功",
        "user":{
            "token":"USER_TOKEN",
            "mobileNum":"13912345678", 
            "nickname":"zhangsan",
            "headImageUrl":"HEADIMAGE_URL"
        }
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"用户登录失败"
    }

需要特别处理的错误码：

    {
        "errcode":?????,"errmsg":"用户登录失败：登录密码错误"
    }



参数|必须|说明
----|----|----
token|是|用户令牌
mobileNum|是|用户手机号码
nickname|是|用户昵称
headImageUrl|是|用户头像地址



##用户基本信息

###查看帐户基础信息接口

本接口用来获取已经登录的用户基本信息，身份证号和手机号码需要加*显示。

1）请求说明


http请求方式: post

    http://IP:PORT/if/userCenter/getUserBaseInfo




POST数据格式：JSON

     {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN"
        }
    }


参数|必须|说明
------|------|-------
token|是|用户令牌


2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"查看帐户基础信息成功", 
        "user":{
            "nickname":"zhangsan",
            "realName":"张三",
            "cardID":"660100198108131211",
            "mobileNum":"13657256722",
            "email":"zhangsan@hang.com",
            "address":"深圳市南山区万科金域华府",
            "headImageUrl":"http://xxxx.xxx/head.jpg"
        }
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"查看帐户基础信息失败",
    }

参数|必须|说明
----|----|----
nickname|是|用户昵称
address|是|联系地址
realName|是|真实姓名
cardID|是|身份证号
mobileNum|是|手机号码
email|是|邮箱
headImageUrl|是|头像


###查询用户状态接口

根据手机号码查询用户状态，用于注册、忘记密码等功能时，判断用户号码是否存在，是否可用等。

1）请求说明

http请求方式: post

    http://IP:PORT/if/userCenter/getUserStatus


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	    "body":{
	       "mobileNum":"13655641234"
	    }
    }


参数|必须|说明
------|------|-------
mobileNum|是|手机号码

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"查询用户状态成功",
        "status":"OK#"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"查询用户状态失败"
    }


参数|必须|说明
----|----|----
status|是|用户存状态，OK#-用户存在且正常，DIS-用户存在但禁用，BLI-黑名单用户，NEX-不存在的用户。


###修改帐户基础信息接口

本接口用于用户修改自己的基本信息。

1）请求说明


http请求方式: post

    http://IP:PORT/if/userCenter/updateUserInfo

POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN",
            "nickname":"zhangsan",
            "address":"",
            "email":""
        }
    }


参数|必须|说明
----|----|----
token|是|用户令牌
nickName|是|用户昵称
address|是|地址
email|是|邮箱

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"修改帐户基础信息成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"修改帐户基础信息失败"
    }

###修改用户头像接口

本接口用于用户修改自己的头像。

1）请求说明

http请求方式: post

    http://IP:PORT/if/userCenter/updateHeadImage

POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN",
            "headImageUrl":"HEAD_IMAGE_URL",
        }
    }


参数|必须|说明
----|----|----
token|是|用户令牌
headImageUrl|是|新的头像链接地址

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"修改用户头像成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"修改用户头像失败失败"
    }


###查询用户开户行信息接口

该接口用来查看用户帐号绑定的开户行信息，开户行包括企业开户行账号，以及个人银行账号

1）请求说明


http请求方式: post

    http://IP:PORT/if/userCenter/getBankInfoList


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "token":"USER_TOKEN"
        }
    }


参数|必须|说明
------|------|-------
token|是|用户令牌


2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"查询成功", 
        "account":[{
                "type":"BIDDEE"
                "accountId":"123123123",
                "accountName":"深圳麦圈",
                "bank":"招商银行"
            },
            {
                "type":"BIDDER"
                "accountId":"123123123",
                "accountName":"深圳麦圈",
                "bank":"招商银行"
            }]
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"查询用户开户行信息失败"
    }


参数|必须|说明
----|----|----
account.type|是|账号类型，BIDDEE-投标人开户行信息，BIDDER-招标人开户行信息
account.accountId|是|银行账号
account.accountName|是|账号名称
account.bank|是|开户行名称


##用户安全信息

###实名校验接口

校验身份证的证件号和姓名是否一致，是否真实。

由于当前未连接公安部的身份证系统，当前只校验身份证号是否正确。

1）请求说明

http请求方式: post

    http://IP:PORT/if/userSecurity/isRealName


POST数据格式：JSON

     {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "realName":"王亚锋",
            "cardID":"610522222222222838"
        }
    }


参数|必须|说明
------|------|-------
realName|是|姓名
cardID|是|身份证号

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"实名校验成功",
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"实名校验失败，其它错误"
    }




###查询用户安全信息接口

本接口用来获取已经登录的用户安全信息，身份证号和手机号码需要加*显示。


1）请求说明


http请求方式: post

    http://IP:PORT/if/userSecurity/getUserSecurityInfo




POST数据格式：JSON

     {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	    "body":{
            "token":"USER_TOKEN"
	    }
    }


参数|必须|说明
------|------|-------
token|是|用户令牌


2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"查看用户安全信息成功", 
        "user":{
            "nickname":"zhangsan",
            "mobileNum":"136****6768",
            "email":"zhangsna@126.com",
            "realName":{
                "name":"*三",
                "cardID":"55****19880910****",
                "isRealName":"TRU"
            }
        }
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"查看用户安全信息失败"
    }

参数|必须|说明
----|----|----
nickname|是|用户昵称
address|是|联系地址
realName.isRealName|是|是否实名认证,TRU-认证通过，FLS-认证失败，NAU-未认证
realName.cardID|是|身份证号，加*输出
realName.name|是|姓名，加*输出
mobileNum|是|手机号码，加*输出
email|是|邮箱


###重置登录密码接口

用户在忘记密码的时候可以通过重置登录密码。该接口仅限于前端使用。

1）请求说明


http请求方式: post

    http://IP:PORT/if/userSecurity/forgetPassword


POST数据格式：JSON

 {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{
            "smsCode":"324545",
            "mobileNum":"13912345678",
            "loginPassword":"LOGIN_PASSWORD"
        }
    }


参数|必须|说明
----|----|----
smsCode|是|短信验证码
loginPassword|是|新登录密码（需要MD5，不允许存储密码）
mobileNum|是|重置密码的手机号

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"重置密码成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"重置密码失败"
    }




###修改登录密码接口

用户自行修改登录密码接口。

1）请求说明


http请求方式: post

    http://IP:PORT/if/userSecurity/updateLoginPassword


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":{   
            "token":"USER_TOKEN",
            "smsCode":"324545",
            "oldLoginPassword":"OLD_LOGIN_PASSWORD",
            "newLoginPassword":"NEW_LOGIN_PASSWORD"
        }
    }


参数|必须|说明
------|------|-------
token|是|用户令牌
smsCode|是|短信验证码
oldLoginPassword|是|旧登录密码，需要MD5
newLoginPassword|是|新登录密码，需要MD5

2）返回说明

正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"修改登录密码成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"修改登录密码失败"
    }

需要特别处理的错误码：

    {
        "errcode":?????,"errmsg":"旧密码错误"
    }

    {
        "errcode":?????,"errmsg":"短信验证码错误"
    }

    {
        "errcode":?????,"errmsg":"用户令牌不存在"
    }


###修改交易密码接口

用户修改自己的交易密码

1）请求说明

http请求方式: post

    http://IP:PORT/if/userSecurity/updateTradePassword


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
    	"body":{
            "token":"USER_TOKEN",
	        "smsCode":"324545",
            "oldTradePassword":"OLD_TRADE_PASSWORD",
	        "newTradePassword":"NEW_TRADE_PASSWORD"
    	}
    }

参数|必须|说明
------|------|-------
token|是|用户令牌
smsCode|是|短信验证码
oldTradePassword|是|旧交易密码md5
newTradePassword|是|新交易密码md5


2）返回说明

正常时的返回JSON数据包示例：

   正常时的返回JSON数据包示例：

    {
        "errcode":0,"errmsg":"修改交易密码成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"修改交易密码失败"
    }

需要特别处理的错误码：

    {
        "errcode":?????,"errmsg":"旧密码错误"
    }

    {
        "errcode":?????,"errmsg":"短信验证码错误"
    }

    {
        "errcode":?????,"errmsg":"用户令牌不存在"
    }


###修改绑定手机号码接口

用户修改绑定的手机号码

1）请求说明

http请求方式: post

    http://IP:PORT/if/userInfo/updateMobileNum


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
	    "body":{
            "token":"USER_TOKEN",
            "firstSmsCode":"324545",
            "secondSmsCode":"435674",
            "loginPassword":"LOGIN_PASSWORD",
            "oldMobileNum":"13512345678",
    	    "newMobileNum":"13687654321"
	    }
    }

参数|必须|说明
------|------|-------
token|是|用户令牌
firstSmsCode|是|第一条短信验证码
secondSmsCode|是|第二条短信验证码
loginPassword|是|登录密码
token|是|用户令牌
oldMobileNum|是|旧手机号码
newMobileNum|是|新手机号码


2）返回说明

正常时的返回JSON数据包示例：


    {
        "errcode":0,"errmsg":"修改手机号码成功"
    }

错误时的JSON数据包示例：

    {
        "errcode":10000,"errmsg":"修改手机号码失败"
    }

需要特别处理的错误码：

    {
        "errcode":?????,"errmsg":"登录密码错误"
    }

    {
        "errcode":?????,"errmsg":"短信验证码错误"
    }

    {
        "errcode":?????,"errmsg":"用户令牌不存在"
    }


