#修订日志

修改日期|修改者|修改说明
------|------|-------
2015-10-12|doudou|Create.
2015-10-13|xuebing|Update.
 

#目的

该文档描述资金管理模块提供前端网站内部访问的接口。

#接口


##充值申请
用户可以通过本接口完成提交充值的申请

1）请求说明

http请求方式: post

前置条件：用户必须先登录，

    http://ip:port/if/capitalmanage/rechargeApply


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":
        {
            "token":"USER_TOKEN",
            "transferDate":"2015-10-12",
            "bankName":"中国银行",
            "voucherNo":"20150101215522",
			"amount":100000
        }

    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌
transferDate|是|转账时间，单位天
bankName|是|银行名称
voucherNo|是|转账凭证号
amount|是|充值金额,单位分

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"提现申请成功"
        "order":{
            "orderId":"ORDERID"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"提现申请失败，其它错误"}


##提现申请

用户可以通过本接口完成提交提现的申请。

1）请求说明

http请求方式: post

前置条件：用户必须先登录，

    http://ip:port/if/capitalmanage/withdrawalsApply


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":
        {
            "token":"USER_TOKEN",
            "openBankType":"BID",
			"amount":100000
        }

    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌
openBankType|是|开户行类型，BID-投标人开户行，TND-招标人开户行
amount|是|提现金额,单位分

2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"提现申请成功"
        "order":{
            "orderId":"ORDERID"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"提现申请失败，其它错误"}


##查询用户资金账户交易记录


1）请求说明

http请求方式: post

前置条件：用户必须先登录，

    http://ip:port/if/capitalmanage/queryTransactionRecords


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":
        {
            "token":"USER_TOKEN",
            "pageIndex":0,
	        "pageSize":20
        }
    } 


参数|是否必须|说明
----|----|-----
token|是|用户令牌
pageIndex|否|页数
pageSize|否|每页显示条数


2）返回说明

正常时的返回JSON数据包示例：
 
    {"errcode":0,"errmsg":"查询资金交易记录成功",
	"list":[
	        {
				"add_time":"2015-09-19 08:21:28",
				"type":"",
				"income":"10000.00",
				"outgo":"0",
				"balance":"2000.00",
				"comment":"xxxx"
			}
	    ]
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询资金交易记录失败，其它错误"}

参数|是否必须|说明
----|----|-----
add_time|是|交易时间
type|是|类型
income|是|收入，单位元
outgo|是|支出，单位元
balance|是|结余，单位元
comment|是|备注

##查询用户可用余额接口

查询用户可用余额

1）请求说明

http请求方式: post

前置条件：用户必须先登录，

    http://ip:port/if/capitalmanage/getBalance


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":
        {
            "token":"USER_TOKEN"
        }
    } 


参数|是否必须|说明
----|----|-----
appId|是|应用ID
timestamp|是|时间戳
nonce|是|随机数
signature|是|签名值,MD5(按值的字典顺序排列组合成字符串(appId,appKey,app.nonce,app.timeStamp))
token|是|用户令牌



2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"查询用户资金账户余额成功",
	    "balance":"10000.00"
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"查询用户资金账户余额失败，其它错误"}

参数|是否必须|说明
----|----|-----
balance|是|可用余额


##冻结保证金接口

为了保证交易的有效性，需要对资金账户中的金额作为保证金进行冻结。

1）请求说明

http请求方式: post

前置条件：用户必须先登录

    http://ip:port/if/capitalmanage/freezeDeposit


POST数据格式：JSON

    {
        "app":{
            "appId":"zjhtwallet",
            "timeStamp":"TIMESTAMP", 
            "nonce":"NONCE",
            "signature":"SIGNATURE"
        },
        "body":
        {
            "token":"USER_TOKEN",
	        "amount":50000,
            "depositType":"BID"
        }

    } 


参数|是否必须|说明
----|----|-----
appId|是|应用ID
timestamp|是|时间戳
nonce|是|随机数
signature|是|签名值,MD5(按值的字典顺序排列组合成字符串(appId,appKey,app.nonce,app.timeStamp))
token|是|用户令牌
amount|是|冻结金额
depositType|是|保证金类型，BID：投标保证金，TND：招标保证金



2）返回说明

正常时的返回JSON数据包示例：
 
    {
        "errcode":0,"errmsg":"冻结保证金成功",
        "order":{
            "orderId":"ORDERID"
        }
    }

错误时的JSON数据包示例：

    {"errcode":10000,"errmsg":"冻结现金失败，其它错误"}

